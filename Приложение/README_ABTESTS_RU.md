# Модуль A/B тестов (Фото / Цена)

В приложении появилась вкладка **«A/B тесты»**.

## Что делает модуль

- **Тест по фото**: вы загружаете 2–4 фото-варианта. Приложение добавляет их в карточку товара и далее **каждые N минут** меняет порядок фото так, чтобы выбранное фото было первым (обложкой).
- **Тест по цене**: вы задаёте 2–4 цены. Приложение **каждые N минут** меняет цену.

## Периодичность

- Ползунок **10..200 минут**.
- Тест работает, пока вкладка открыта (это важно).

## Метрики и CTR

Метрики берутся из **рекламных кампаний WB** (через Ads API):
- просмотры
- клики
- добавления в корзину
- заказы
- CTR = клики / просмотры * 100%

Мы делаем так:
1) Запоминаем общие totals по nmId на текущий день.
2) Через N минут снова снимаем totals.
3) Разницу (дельту) относим к текущему варианту.

## Как пользоваться

1) Откройте вкладку «A/B тесты».
2) Введите **артикул продавца** (vendorCode) *или* **nmId** товара и нажмите «Найти товар».
3) Нажмите **«Подтянуть кампании»** — приложение покажет рекламные кампании и попробует автоматически выбрать те, где встречается nmId.
4) Выберите тип теста:
   - **Фото**: загрузите 2–4 фото (они добавятся в карточку). Потом нажмите «Запустить тест».
   - **Цена**: нажмите «Получить базовую цену», задайте 2–4 цены, нажмите «Запустить тест».
5) Смотрите отчёт справа.
6) По кнопке **«Остановить и восстановить»** — вернётся базовое фото/цена.

## Токены и галочки при создании

В приложении используется **2 токена** (так надёжнее и проще отлаживать права):

### 1) Токен продавца (отзывы/контент/цены)

При создании токена в кабинете продавца поставьте галочки:
- **Feedbacks and Questions** (нужно для ответов на отзывы)
- **Content** (нужно для фото в A/B тесте)
- **Prices and Discounts** (нужно для A/B теста по цене)

Уровень доступа: **Read and Write**.

### 2) Токен WB Ads (Promotion)

Поставьте галочку:
- **Promotion**

Уровень доступа: **Read only** достаточно (мы только читаем статистику/кампании).

Если видите **401** — обычно это значит, что токен не подходит по категории или просрочен.
